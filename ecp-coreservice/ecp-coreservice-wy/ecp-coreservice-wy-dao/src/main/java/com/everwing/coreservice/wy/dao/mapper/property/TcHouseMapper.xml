<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.everwing.coreservice.wy.dao.mapper.property.TcHouseMapper">	<!-- 基本视图 -->	<resultMap id="BaseResultMap" type="TcHouse">		<result property="id" column="id"/>		<result property="buildingCode" column="building_code"/>		<result property="name" column="name"/>		<result property="createrId" column="creater_id"/>		<result property="createrName" column="creater_name"/>		<result property="modifyId" column="modify_id"/>		<result property="modifyName" column="modify_name"/>		<result property="createTime" column="create_time"/>		<result property="modifyTime" column="modify_time"/>	</resultMap>	<!-- 自定义视图  -->	<resultMap id="ListResultMap" type="TcHouseList" extends="BaseResultMap">		<result property="houseFullName" column="building_full_name"/>		<result property="marketStateName" column="market_state_name"/>		<result property="housePropertyName" column="house_property_name"/>		<result property="houseTypeName" column="house_type_name"/>	</resultMap>	<!--  -->	<select id="listPageHouse" parameterType="TcHouseSearch" resultMap="ListResultMap">		SELECT			h.id,			h.house_type,			h.house_property,			h.project_number,			h.house_name,			b.building_code,			b.house_code,			b.building_full_name AS building_full_name,			b.building_area AS house_area,			b.usable_area,			b.finish_area,			b.share_area,			b.finish_date,			b.building_certificate,			b.unit_wy_price,			b.unit_bt_price,			b.market_state,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@marketState.name()}' AND li.`code` = b.market_state) as market_state_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@houseProperty.name()}' AND li.`code` = h.house_property) as house_property_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@houseType.name()}' AND li.`code` = h.house_type) as house_type_name		FROM tc_building b LEFT JOIN tc_house h ON h.building_code = b.building_code WHERE 1 = 1		<if test="projectCode != null and projectCode != ''">			AND b.project_id = #{projectCode}		</if>		<if test="buildingCode != null and buildingCode != ''">			AND b.building_code = #{buildingCode}		</if>		ORDER BY b.house_code ASC	</select>	<!--  -->	<select id="findByCondition" parameterType="TcHouseSearch" resultMap="ListResultMap">		SELECT		    h.*,			b.building_full_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@marketState.name()}' AND li.`code` = h.market_state) as market_state_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@houseProperty.name()}' AND li.`code` = h.house_property) as house_property_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@houseType.name()}' AND li.`code` = h.house_type) as house_type_name		FROM tc_house h,tc_building b WHERE h.building_code = b.building_code		<if test="projectCode != null and projectCode != ''">			AND b.project_id = #{projectCode}		</if>		<if test="buildingCode != null and buildingCode != ''">			AND h.building_code = #{buildingCode}		</if>		ORDER BY b.house_code ASC	</select>	<!-- 统计住宅信息 -->	<select id="countHouse" parameterType="String" resultType="CountHouseList">		SELECT			ROUND(SUM(b.building_area), 2) AS houseAreaSum,			ROUND(SUM(b.usable_area), 2) AS usableAreaSum,			ROUND(SUM(b.share_area), 2) AS shareAreaSum,			ROUND(SUM(b.finish_area), 2) AS finishAreaSum,			COUNT(*) AS allCount,			SUM(b.market_state = '002') AS soldCount		FROM tc_building b		WHERE b.project_id = #{0} AND b.building_type = 'house' AND b.building_full_name LIKE  CONCAT(#{1},'%')	</select>	<!-- 单个添加 -->	<insert id="insert"  parameterType="TcHouse">		INSERT INTO tc_house (			id,			building_code,			name,			creater_id,			creater_name,			modify_id,			modify_name,			create_time,			modify_time		) Values(			UUID(),			#{buildingCode},			#{name},			#{createrId},			#{createrName},			#{modifyId},			#{modifyName},			sysdate(),			sysdate()		)	</insert>	<!-- 批量添加 -->	<insert id="batchInsert" parameterType="java.util.List">		insert into tc_house(			id,			building_code,			name,			creater_id,			creater_name,			modify_id,			modify_name,			create_time,			modify_time		)		values		<foreach collection="list" index="index" item="item" separator=",">			(				UUID(),				#{item.buildingCode},				#{item.name},				#{item.createrId},				#{item.createrName},				#{item.modifyId},				#{item.modifyName},				sysdate(),				sysdate()			)		</foreach>	</insert>	<!-- 单个修改 -->	<update id="modify" parameterType="TcHouse" >		UPDATE tc_house		<set>			name = #{name},			modify_id = #{modifyId},			modify_name = #{modifyName},			modify_time = syddate()		</set>		where 1=1		<if test="id != null and id != ''">			AND id = #{id}		</if>		<if test="buildingCode != null and buildingCode != ''">			AND building_code = #{buildingCode}		</if>	</update>	<update id="batchModify" parameterType="java.util.List">		<foreach collection="list" separator=";" index="index" item="item">			UPDATE tc_house SET					name = #{item.name},					modify_id = #{item.modifyId},					modify_name = #{item.modifyName},					modify_time = syddate()			WHERE 1=1			<if test="item.id != null and item.id != ''">				AND id = #{item.id}			</if>			<if test="item.buildingCode != null and item.buildingCode != ''">				AND building_code = #{item.buildingCode}			</if>		</foreach>	</update>	<!-- 批量删除  -->	<delete id="batchDelete" parameterType="java.util.List">		delete from tc_house where building_code IN		<foreach collection="list" item = "buildingCode" open="(" separator="," close=")">			#{buildingCode }		</foreach>	</delete>		<!-- 根据projectId获取该项目下所有的tc_house数据 -->	<select id="findCanChargingHouse" parameterType="java.lang.String" resultType="java.util.Map">		SELECT t2.building_code AS buildingCode,		       t2.building_full_name AS buildingFullName,		       t1.unit_bt_price AS btPrice,		       t1.unit_wy_price AS wyPrice		  FROM tc_house t1,		       tc_building t2,		       t_sys_project t3		 WHERE t1.building_code = t2.building_code		  AND t2.project_id = t3.code		  AND t3.project_id = #{0}		  AND t2.is_charge_obj = '@{com.everwing.coreservice.common.wy.common.enums.LookupItemEnum@yesNo_yes.name()}';	</select>		<select id="findByBuildingCode" parameterType="String" resultMap="BaseResultMap">		select t1.unit_bt_price, 			   t1.unit_wy_price,			   t1.house_area,			   t1.usable_area	      from tc_house t1	     where building_code = #{0}	</select></mapper>