<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.everwing.coreservice.wy.dao.mapper.product.TProductOrderDetailMapper">	<resultMap id="BaseResultMap" type="TProductOrderDetail">		<result property="id" column="id"/>		<result property="orderId" column="order_id"/>		<result property="orderBatchNo" column="order_batch_no"/>		<result property="price" column="price"/>		<result property="quantity" column="quantity"/>		<result property="orderAmount" column="order_amount"/>		<result property="buyBeginDate" column="buy_begin_date"/>		<result property="buyEndDate" column="buy_end_date"/>		<result property="description" column="description"/>		<result property="customerId" column="customer_id"/>		<result property="houseCodeNew" column="house_code_new"/>		<result property="vehicleNumber" column="vehicle_number"/>		<result property="productCode" column="product_code"/>		<result property="productCommon" column="product_common"/>		<result property="createrId" column="creater_id"/>		<result property="createrName" column="creater_name"/>		<result property="createTime" column="create_time"/>	</resultMap>	<resultMap id="ListResultMap" type="TProductOrderDetailList" extends="BaseResultMap">	</resultMap>	<select id="listPage" parameterType="TProductOrderDetailSearch" resultMap="ListResultMap">		select * from t_product_order_detail po where 1=1		<if test="orderId != null and orderId != ''">			AND po.order_id = #{orderId}		</if>		<if test="orderBatchNo != null and orderBatchNo != ''">			AND po.order_batch_no = #{orderBatchNo}		</if>		<if test="houseCodeNew != null and houseCodeNew != ''">			AND po.house_code_new = #{houseCodeNew}		</if>		<if test="productCode != null and productCode != ''">			AND po.product_code = #{productCode}		</if>		<if test="productCommon != null and productCommon != ''">			AND po.product_common LIKE CONCAT('%',#{productCommon},'%')		</if>	</select>	<select id="findByCondition" parameterType="TProductOrderDetailSearch" resultMap="ListResultMap">		select * from t_product_order_detail po where 1=1		<if test="orderId != null and orderId != ''">			AND po.order_id = #{orderId}		</if>		<if test="orderBatchNo != null and orderBatchNo != ''">			AND po.order_batch_no = #{orderBatchNo}		</if>		<if test="productCode != null and productCode != ''">			AND po.product_code = #{productCode}		</if>		<if test="orderIdList != null">			AND po.order_id IN			<foreach collection="orderIdList" item="item" index="index" open="(" close=")" separator=",">				'${item}'			</foreach>		</if>		<if test="productCommon != null and productCommon != ''">			AND po.product_common LIKE CONCAT('%',#{productCommon},'%')		</if>	</select>	<!-- 根据产品编码获取正在生效的产品订单（即已经卖出去，但产品的出卖时间还未到期） -->	<select id="findSoldProductByProductCode" parameterType="String" resultMap="ListResultMap">		SELECT			pod.product_common		FROM			t_product_order po,			t_product_order_detail pod		WHERE			po.id = pod.order_id			AND po.`status` = 'success'			AND DATE_FORMAT(CURRENT_DATE, '%Y-%m-%d') &lt;= DATE_FORMAT(pod.buy_end_date,'%Y-%m-%d')			AND pod.product_code = #{0}	</select>	<!-- 根据产品编码获取最新订单 -->	<select id="findRecentProductOrderByProductCode" parameterType="String" resultMap="ListResultMap">		SELECT			pod.*		FROM			t_product_order po,			t_product_order_detail pod		WHERE			po.id = pod.order_id			AND po.`status` = 'success'			AND pod.product_code = #{0}			ORDER BY pod.create_time DESC	</select>	<insert id="batchInsert" parameterType="List">		INSERT INTO t_product_order_detail		(			id,			order_id,			order_batch_no,			price,			quantity,			order_amount,			buy_begin_date,			buy_end_date,			description,			customer_id,			house_code_new,			vehicle_number,			product_code,			product_common,			creater_id,			creater_name,			create_time		)		VALUES		<foreach collection="list" index="index" item="item" separator=",">		(			UUID(),			#{item.orderId},			#{item.orderBatchNo},			#{item.price},			#{item.quantity},			#{item.orderAmount},			#{item.buyBeginDate},			#{item.buyEndDate},			#{item.description},			#{item.customerId},			#{item.houseCodeNew},			#{item.vehicleNumber},			#{item.productCode},			#{item.productCommon},			#{item.createrId},			#{item.createrName},			sysdate()		)		</foreach>	</insert></mapper>