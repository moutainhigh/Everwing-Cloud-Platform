<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.everwing.coreservice.wy.dao.mapper.property.TcSurfaceWaterMapper">	<resultMap id="BaseResultMap" type="TcWaterMeter">		<result property="id" column="id" />		<result property="code" column="code" />		<result property="waterMeterName" column="water_meter_name" />		<result property="position" column="position" />		<result property="relationBuilding" column="relation_building" />		<result property="companyCode" column="company_code" />		<result property="projectId" column="project_id" />		<result property="rate" column="rate" />		<result property="initAmount" column="init_amount" />		<result property="minAmount" column="min_amount" />		<result property="maxAmount" column="max_amount" />		<result property="isCircle" column="is_circle" />		<result property="state" column="state" />		<result property="type" column="type" />		<result property="parentCode" column="parent_code" />		<result property="masterCode" column="master_code" />		<result property="userType" column="user_type"/>		<result property="isBilling" column="is_billing" />		<result property="isPublic" column="is_public" />		<result property="assetNo" column="asset_no" />		<result property="brand" column="brand" />		<result property="specs" column="specs" />		<result property="provider" column="provider" />		<result property="providerPhone" column="provider_phone" />		<result property="assemblePerson" column="assemble_person"/>		<result property="assembleTime" column="assemble_time"/>		<result property="createId" column="create_id" />		<result property="createTime" column="create_time"/>		<result property="modifyId" column="modify_id" />		<result property="modifyTime" column="modify_time"  />		<result property="modifyName" column="modify_name"  />		<result property="meterLevel" column="meter_level" />		<result property="checkTable" column="check_table" />		<result property="describeNum" column="describe_num" />		<result property="groupTableCoding" column="group_table_coding" />		<result property="groupTableName" column="group_table_name" />		<result property="isShare" column="is_share" />		<result property="newCoding" column="new_coding" />		<result property="paymentObject" column="payment_object" />		<result property="externalCoding" column="external_coding" />		<result property="waterState" column="water_state" />		<result property="waterCode" column="water_code" />		<result property="parentTable" column="parent_table" />	</resultMap>	<!-- 查询 -->	<select id="listPageWaterMeterInfos" parameterType="TcWaterMeterSearch" resultMap="BaseResultMap">		select  b.building_full_name AS waterCode   ,		CAST((select COUNT(*) from tc_water_meter where parent_code = t.code )as char)  parentTable,		t.*		FROM   tc_water_meter   t		LEFT JOIN tc_building b ON b.house_code_new =t.water_code		where 1 = 1		<if test="code != null and code != ''">			AND code LIKE CONCAT(CONCAT('%',#{code}),'%')		</if>	</select>	<select id="listPageWaterTree" parameterType="TcWaterMeterSearch" resultMap="BaseResultMap">		select   *		FROM   tc_water_meter		where 1 = 1		AND  meter_level =1		<if test="code != null and code != ''">			AND code LIKE CONCAT(CONCAT('%',#{code}),'%')		</if>	</select>	<!-- 查询 -->	<select id="listPageParentCodeInfos" parameterType="TcWaterMeterSearch" resultMap="BaseResultMap">		select  b.building_full_name AS waterCode,t.*		FROM   tc_water_meter   t		LEFT JOIN tc_building b ON b.house_code_new =t.water_code		WHERE check_table=0  AND  meter_level !=12		<if test="code != null and code != ''">			AND code LIKE CONCAT(CONCAT('%',#{code}),'%')		</if>	</select>	<select id="repeatWaterMeterCode" parameterType="TcWaterMeterSearch" resultMap="BaseResultMap">		SELECT COUNT(1) FROM tc_water_meter WHERE CODE=#{code}	</select>	<!-- 新增水表基础数据信息 -->	<insert id="insert" parameterType="TcWaterMeter">		INSERT INTO tc_water_meter					(			id,			code,			water_meter_name,			`position`,			relation_building,			company_code,			project_id,			rate,			init_amount,			min_amount,			max_amount,			is_circle,			state,			`type`,			parent_code,			master_code,			user_type,			is_billing,			is_public,			asset_no,			brand,			specs,			provider,			provider_phone,			assemble_person,			assemble_time,			create_id,			create_time,			modify_id,			modify_time,			meter_level,			modify_name,			check_table,			describe_num,			group_table_coding,			group_table_name,			is_share,			new_coding,			payment_object,			external_coding,			water_state,			water_code			)		VALUES(		#{id},		#{code},		#{waterMeterName},		#{position},		#{relationBuilding},		#{companyCode},		#{projectId},		#{rate},		#{initAmount},		#{minAmount},		#{maxAmount},		#{isCircle},		#{state},		#{type},		#{parentCode},		#{masterCode},		#{userType},		#{isBilling},		#{isPublic},		#{assetNo},		#{brand},		#{specs},		#{provider},		#{providerPhone},		#{assemblePerson},		#{assembleTime},		#{createId},		#{createTime},		#{modifyId},		#{modifyTime},		#{meterLevel},		#{modifyName},		#{checkTable},		#{describeNum},		#{groupTableCoding},		#{groupTableName},		#{isShare},		#{newCoding},		#{paymentObject},		#{externalCoding},		#{waterState},		#{waterCode}		)	</insert>	<!-- 修改水表基础数据信息 -->	<update id="modify" parameterType="TcWaterMeter">			UPDATE tc_water_meter			<set>				code=#{code},				water_meter_name = #{waterMeterName},				`position` = #{position},				relation_building = #{relationBuilding},				company_code = #{companyCode},				rate = #{rate},				init_amount = #{initAmount},				min_amount = #{minAmount},				max_amount = #{maxAmount},				is_circle = #{isCircle},				state = #{state},				`type` = #{type},				parent_code = #{parentCode},				master_code = #{masterCode},				user_type = #{userType},				is_billing = #{isBilling},				is_public = #{isPublic},				asset_no = #{assetNo},				brand = #{brand},				specs = #{specs},				provider = #{provider},				provider_phone = #{providerPhone},				assemble_person = #{assemblePerson},				assemble_time = #{assembleTime},				create_time = #{createTime},				modify_id=#{modifyId},				modify_time=#{modifyTime},              	meter_level=#{meterLevel},				modify_name=#{modifyName},				check_table=#{checkTable},				describe_num=#{describeNum},				group_table_coding=#{groupTableCoding},				group_table_name=#{groupTableName},				is_share=#{isShare},				new_coding=#{newCoding},				payment_object=#{paymentObject},				external_coding=#{externalCoding},				project_id=#{projectId},				water_code=#{waterCode}			</set>			where    1=1		AND id = #{id}	</update>	<delete id="deleteSurface" parameterType="String">	 delete from tc_water_meter where 1 = 1  and id = #{Id}	</delete>	<!-- 查询最大流水码 以项目为准 -->	<select id="getCode" parameterType = "string" resultType="string">		select IFNULL(SUBSTR(MAX(code) FROM 5 FOR 9),0) + 1 from tc_water_meter tt where 1 = 1		AND tt.project_id = #{projectId}	</select>	<select id="SeleteByID" parameterType="string" resultMap="BaseResultMap">		select * from tc_water_meter where id = #{0}	</select></mapper>