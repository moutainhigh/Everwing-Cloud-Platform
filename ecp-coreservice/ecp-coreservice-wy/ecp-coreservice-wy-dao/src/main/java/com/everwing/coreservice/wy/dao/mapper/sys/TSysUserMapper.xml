<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.everwing.coreservice.wy.dao.mapper.sys.TSysUserMapper">	<resultMap type="TSysUser" id="BaseResultMap">		<result property="userId" column="user_id"/>		<result property="staffNumber" column="staff_number"/>		<result property="staffName" column="staff_name"/>		<result property="documentType" column="document_type"/>		<result property="documentNumber" column="document_number"/>		<result property="sex" column="sex"/>		<result property="email" column="email"/>		<result property="image" column="image"/>		<result property="mobileTelephone" column="mobile_telephone"/>		<result property="joinDate" column="join_date"/>		<result property="loginName" column="login_name"/>		<result property="password" column="password"/>		<result property="status" column="status"/>		<result property="companyId" column="company_id"/>		<result property="type" column="type"/>		<result property="staffState" column="staff_state"/>		<result property="fileIds" column="file_ids"/>		<result property="createrId" column="creater_id"/>		<result property="createrName" column="creater_name"/>		<result property="modifyId" column="modify_id"/>		<result property="modifyName" column="modify_name"/>		<result property="createTime" column="create_time"/>		<result property="modifyTime" column="modify_time"/>	</resultMap>	<resultMap id="ListResultMap" type="TSysUserList" extends="BaseResultMap">		<result property="sexName" column="sex_name"/>		<result property="statusName" column="status_name"/>		<result property="staffStateName" column="staff_state_name"/>		<result property="documentTypeName" column="document_type_name"/>	</resultMap>	<resultMap type="com.everwing.coreservice.common.wy.entity.system.user.UserResourceList" id="UserResourceList">		<result property="staffId" column="staff_id"/>		<result property="loginName" column="login_name"/>		<result property="staffNumber" column="staff_number"/>		<result property="staffName" column="staff_name"/>		<result property="roleId" column="role_id"/>		<result property="roleName" column="role_name"/>		<result property="departmentId" column="department_id"/>		<result property="departmentCode" column="department_code"/>		<result property="departmentName" column="department_name"/>		<result property="projectId" column="project_id"/>		<result property="projectCode" column="project_code"/>		<result property="projectName" column="project_name"/>		<result property="companyId" column="company_id"/>		<result property="companyCode" column="company_code"/>		<result property="companyName" column="company_name"/>	</resultMap>	<sql id="SQL_USERLIST_QUERY">		SELECT			t.user_id,			t.staff_number,			t.staff_name,			t.document_type,			t.document_number,			t.image,			t.mobile_telephone,			t.join_date,			t.login_name,			t.company_id,			t.sex,			t.type,			t.status,			t.staff_state,			t.creater_id,			t.creater_name,			t.create_time,			t.modify_id,			t.modify_name,			t.modify_time		FROM t_sys_user t WHERE 1=1	</sql>		<sql id="sql_where">		<if test="loginName != null and loginName != ''">			AND login_name LIKE CONCAT(CONCAT('%',#{loginName}),'%')		</if>		<if test="staffNumber !=null and staffNumber !=''">			AND staff_number=#{staffNumber}		</if>		<if test="staffName !=null and staffName !=''">			AND staff_name like CONCAT('%',#{staffName},'%')		</if>		<if test="mobileTelephone !=null and mobileTelephone !=''">			AND mobile_telephone like CONCAT('%',#{mobileTelephone},'%')		</if>		<if test="documentNumber !=null and documentNumber !=''">			AND document_number like CONCAT('%',#{documentNumber},'%')		</if>		<if test="staffState != null and staffState != ''">			AND staff_state = #{staffState}		</if>		<if test="type != null and type != ''">			AND type = #{type}		</if>	</sql>	<select id="selectByCompanyId"  resultType="Map">		SELECT user_id personId,staff_name personName FROM t_sys_user WHERE status='enable' AND company_id=#{companyId}	</select>	<select id="listPageUser" parameterType="TSysUserSearch" resultMap="ListResultMap">		<include refid="SQL_USERLIST_QUERY"></include>		<if test="loginName != null and loginName != ''">			AND login_name LIKE CONCAT(CONCAT('%',#{loginName}),'%')		</if>		<if test="staffNumber !=null and staffNumber !=''">			AND staff_number LIKE CONCAT('%',#{staffNumber},'%')		</if>		<if test="staffName !=null and staffName !=''">			AND staff_name LIKE CONCAT('%',#{staffName},'%')		</if>		<if test="mobileTelephone !=null and mobileTelephone !=''">			AND mobile_telephone=#{mobileTelephone}		</if>		<if test="staffState != null and staffState != ''">			AND staff_state = #{staffState}		</if>		<if test="type != null and type != ''">			AND type = #{type}		</if>		<if test="staffNumberList != null">			AND t.staff_number IN			<foreach collection="staffNumberList" item="item" index="index" open="(" close=")" separator=",">				'${item}'			</foreach>		</if>		ORDER BY login_name ASC	</select>	<select id="findByCondition" parameterType="TSysUserSearch" resultMap="ListResultMap">		<include refid="SQL_USERLIST_QUERY"></include>		<if test="userId != null and userId != ''">			AND user_id = #{userId}		</if>		<if test="staffNumber != null and staffNumber != ''">			AND staff_number = #{staffNumber}		</if>		<if test="loginName != null and loginName != ''">			AND login_name = #{loginName}		</if>		<if test="password != null and password != ''">			AND password = #{password}		</if>		<if test="type != null and type != ''">			AND type = #{type}		</if>		<if test="staffState != null and staffState != ''">			AND staff_state = #{staffState}		</if>		ORDER BY login_name ASC	</select>	<select id="findUserByKey" parameterType="String" resultMap="ListResultMap">		SELECT * FROM t_sys_user u WHERE u.login_name = #{0} OR u.staff_number = #{0}	</select>	<insert id="insert" parameterType="TSysUser">		insert into t_sys_user		(			user_id,			staff_number,			staff_name,			document_type,			document_number,			sex,			image,			mobile_telephone,			join_date,			login_name,			password,			staff_state,			status,			company_id,			type,			creater_id,			creater_name,			create_time		)		values		(			#{userId},			#{staffNumber},			#{staffName},			#{documentType},			#{documentNumber},			#{sex},			#{image},			#{mobileTelephone},			sysdate(),			#{loginName},			#{password},			#{staffState},			#{status},			#{companyId},			#{type},			#{createrId},			#{createrName},			sysdate()		)	</insert>	<update id="modify" parameterType="TSysUser">		UPDATE t_sys_user t		SET			staff_number = #{staffNumber},			staff_name = #{staffName},			document_type = #{documentType},			document_number = #{documentNumber},			sex = #{sex},			image = #{image},			mobile_telephone = #{mobileTelephone},			join_date = #{joinDate},			login_name = #{loginName},			password = #{password},			staff_state = #{staffState},			company_id = #{companyId},			status = #{status},			modify_id = #{modifyId},			modify_name = #{modifyName},			modify_time = sysdate()		WHERE t.login_name = #{loginName}	</update>	<!-- 获取最大的员工号 -->	<select id="getMaxStaffNumber" resultType="String">		SELECT MAX(t.staff_number) FROM t_sys_user t	</select>		<!-- 分页查询员工,其他渠道使用,使用模糊匹配手机号,员工名 -->	<select id="listPageOther" parameterType="TSysUserSearch" resultMap="ListResultMap">		<include refid="SQL_USERLIST_QUERY"></include>		<include refid="sql_where"/>		ORDER BY staff_name ASC	</select>		<!-- 分页查询员工, 银账交割: 同一项目下同一员工只能出现一次 -->	<select id="listPageUserInJg" parameterType="TSysUserSearch" resultMap="BaseResultMap">		SELECT * 		  FROM t_sys_user 		 WHERE user_id NOT IN 				(				 SELECT user_id  				   FROM t_jg_staff_grop				  WHERE project_id = #{projectId}			   GROUP BY user_id				)		  AND status = 'enable'		  AND staff_state = 'joined'		  <include refid="sql_where"/>	</select>	<select id="selectByPrimaryKey" resultMap="BaseResultMap">		<include refid="SQL_USERLIST_QUERY"></include>		and user_id=#{principalSysUserId}	</select></mapper>