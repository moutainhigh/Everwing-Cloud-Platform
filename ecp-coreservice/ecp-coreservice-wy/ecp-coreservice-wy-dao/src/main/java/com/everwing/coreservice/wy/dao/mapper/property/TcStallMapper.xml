<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" ><mapper namespace="com.everwing.coreservice.wy.dao.mapper.property.TcStallMapper">	<!-- 基本视图 -->	<resultMap id="BaseResultMap" type="TcStall">		<result property="id" column="id"/>		<result property="buildingCode" column="building_code"/>		<result property="name" column="name"/>		<result property="isMechanicalStall" column="is_mechanical_stall"/>		<result property="stallType" column="stall_type"/>		<result property="administrativeExpenese" column="administrative_expenese"/>		<result property="createrId" column="creater_id"/>		<result property="createrName" column="creater_name"/>		<result property="modifyId" column="modify_id"/>		<result property="modifyName" column="modify_name"/>		<result property="createTime" column="create_time"/>		<result property="modifyTime" column="modify_time"/>	</resultMap>	<!-- 自定义视图  -->	<resultMap id="ListResultMap" type="TcStallList" extends="BaseResultMap">		<result property="stallFullName" column="building_full_name"/>		<result property="marketStateName" column="market_state_name"/>		<result property="stallPropertyName" column="stall_property_name"/>		<result property="stallTypeName" column="stall_type_name"/>		<result property="isMechanicalStallName" column="is_mechanical_stall_name"/>	</resultMap>	<!-- 车位列表 -->	<select id="listPageStall" parameterType="TcStallSearch" resultMap="ListResultMap">		SELECT			s.id,			s.name,			s.is_mechanical_stall,			s.stall_Type,			s.administrative_expenese,			b.building_code,			b.house_code AS stall_code,			b.building_full_name AS building_full_name,			b.building_area AS house_area,			b.usable_area,			b.finish_area,			b.share_area,			b.finish_date,			b.building_certificate,			b.market_state,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@marketState.name()}' AND li.`code` = b.market_state) as market_state_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@stationProperty.name()}' AND li.`code` = s.stall_property) as stall_property_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = 'stationType' AND li.`code` = s.stall_type) as stall_type_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@yesNo.name()}' AND li.`code` = s.is_mechanical_stall) as is_mechanical_stall_name		FROM tc_building b LEFT JOIN tc_stall s ON s.building_code = b.building_code WHERE 1=1		<if test="projectCode != null and projectCode != ''">			AND b.project_id = #{projectCode}		</if>		<if test="buildingCode != null and buildingCode != ''">			AND b.building_code = #{buildingCode}		</if>		ORDER BY b.house_code ASC	</select>	<!-- 获取指定条件的信息集合 -->	<select id="findByCondition" parameterType="TcStallSearch" resultMap="ListResultMap">		SELECT		    s.*,			b.building_full_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@marketState.name()}' AND li.`code` = s.market_state) as market_state_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@stationProperty.name()}' AND li.`code` = s.stall_property) as stall_property_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = 'stationType' AND li.`code` = s.stall_type) as stall_type_name,			(SELECT li.`name` FROM t_sys_lookup_item li WHERE li.parent_code = '${@com.everwing.coreservice.common.wy.common.enums.LookupEnum@yesNo.name()}' AND li.`code` = s.is_mechanical_stall) as is_mechanical_stall_name		FROM tc_stall s,tc_building b WHERE s.building_code = b.building_code		<if test="projectCode != null and projectCode != ''">			AND b.project_id = #{projectCode}		</if>		<if test="buildingCode != null and buildingCode != ''">			AND s.building_code = #{buildingCode}		</if>		ORDER BY b.house_code ASC	</select>		<select id="findByBuildingCode" parameterType="String" resultMap="BaseResultMap">		SELECT s.* FROM tc_stall s WHERE s.building_code =#{0} LIMIT 1	</select>	<!-- 统计住宅信息 -->	<select id="countStall" parameterType="String" resultType="CountStallList">		SELECT			SUM(s.stall_Type = '001') AS openParkingCount,			SUM(s.stall_Type = '002') AS fixedParkingCount,			SUM(s.stall_Type = '003') AS privateParkingCount,			COUNT(*) AS allCount,			SUM(s.market_state = '002') AS soldCount		FROM tc_building b,tc_stall s		WHERE b.building_code = s.building_code AND b.project_id = #{0} AND b.building_type = 'parkspace' AND b.building_full_name LIKE  CONCAT(#{1},'%')	</select>	<!-- 单个添加 -->	<insert id="insert"  parameterType="TcStall">		INSERT INTO tc_stall (			id,			building_code,			name,			is_mechanical_stall,			stall_Type,			administrative_expenese,			creater_id,			creater_name,			modify_id,			modify_name,			create_time,			modify_time		) Values(			UUID(),			#{buildingCode},			#{name},			#{isMechanicalStall},			#{stallType},			#{administrativeExpenese},			#{createrId},			#{createrName},			#{modifyId},			#{modifyName},			sysdate(),			sysdate()		)	</insert>	<!-- 批量添加 -->	<insert id="batchInsert" parameterType="java.util.List">		insert into tc_stall(			id,			building_code,			name,			is_mechanical_stall,			stall_Type,			administrative_expenese,			creater_id,			creater_name,			modify_id,			modify_name,			create_time,			modify_time		)		values		<foreach collection="list" index="index" item="item" separator=",">			(			UUID(),			#{item.buildingCode},			#{item.name},			#{item.isMechanicalStall},			#{item.stallType},			#{item.administrativeExpenese},			#{item.createrId},			#{item.createrName},			#{item.modifyId},			#{item.modifyName},			sysdate(),			sysdate()			)		</foreach>	</insert>	<!-- 单个修改 -->	<update id="modify" parameterType="TcStall" >		UPDATE tc_stall		<set>			is_Mechanical_Stall = #{isMechanicalStall},			name = #{name},			stall_Type = #{stallType},			administrative_expenese = #{administrativeExpenese},			modify_id = #{modifyId},			modify_name = #{modifyName},			modify_time = sysdate()		</set>		where 1=1		<if test="id != null and id != ''">			AND id = #{id}		</if>		<if test="buildingCode != null and buildingCode != ''">			AND building_code = #{buildingCode}		</if>	</update>	<update id="batchModify" parameterType="java.util.List">		<foreach collection="list" separator=";" index="index" item="item">			UPDATE tc_stall SET				is_Mechanical_Stall = #{item.isMechanicalStall},				name = #{item.name},				stall_Type = #{item.stallType},				administrative_expenese = #{item.administrativeExpenese},				modify_id = #{item.modifyId},				modify_name = #{item.modifyName},				modify_time = sysdate()			WHERE 1=1			<if test="item.id != null and item.id != ''">				AND id = #{item.id}			</if>			<if test="item.buildingCode != null and item.buildingCode != ''">				AND building_code = #{item.buildingCode}			</if>		</foreach>	</update>	<!-- 批量删除  -->	<delete id="batchDelete" parameterType="java.util.List">		delete from tc_stall where building_code IN		<foreach collection="list" item = "buildingCode" open="(" separator="," close=")">			#{buildingCode }		</foreach>	</delete></mapper>